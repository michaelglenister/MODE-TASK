

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Normal Mode Analysis (NMA) &mdash; Mode-Task  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Mode-Task  documentation" href="index.html"/>
        <link rel="next" title="NMA Scripts" href="nma_use.html"/>
        <link rel="prev" title="Installation" href="installation.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Mode-Task
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Theory</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Normal Mode Analysis (NMA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="#principle-component-analysis-pca">Principle Component Analysis (PCA)</a></li>
</ul>
<p class="caption"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nma_use.html">NMA Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="pca_use.html">PCA Scripts</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nma_tut.html">NMA Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="pca_tut.html">PCA Tutorial</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Mode-Task</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Normal Mode Analysis (NMA)</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/theory.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="normal-mode-analysis-nma">
<h1>Normal Mode Analysis (NMA)<a class="headerlink" href="#normal-mode-analysis-nma" title="Permalink to this headline">¶</a></h1>
<p>NMA analyses the oscillations of a structure. For proteins, it is useful for studying the large amplitude motions for a selected conformation. The main assumption is that the motions are harmonic. Thus, each normal mode, which is a concerted motion of many atoms, acts as a simple harmonic oscillator and it is independent of all the other normal modes.</p>
<p>For a harmonic oscillator with a mass <span class="math">\(m\)</span> supported on a spring with force constant <span class="math">\(k\)</span>, the potential energy of the system, <span class="math">\(V = kx^2\)</span>, for an extension <span class="math">\(x\)</span> leads to the restoring force,</p>
<div class="math">
\[\mathbf{F} = -\frac{dV}{dx} = -kx\]</div>
<p>By substituting this Hooke’s Law force into Newton’s Law, <span class="math">\(\mathbf{F} = m\mathbf{a}\)</span> leads to the differential equation,</p>
<div class="math">
\[-kx = m\frac{d^2x}{dt^2}\]</div>
<p>The solution is,</p>
<div class="math">
\[-kx = -4{\pi}^2v^2mx\]</div>
<p>with <span class="math">\(v\)</span> being the frequency of the vibration.</p>
<p>In three dimensions and for a set of <span class="math">\(N\)</span> atoms, one has the corresponding generalized equation,</p>
<p><span class="math">\(-\mathbf{HX} = -4{\pi}^2v^2\mathbf{X}\)</span></p>
<p>where <span class="math">\(\mathbf{H}\)</span> is the <span class="math">\(3N\)</span>x<span class="math">\(3N\)</span> Hessian symmetric matrix of force constants and <span class="math">\(\mathbf{X}\)</span> is the <span class="math">\(3N\)</span>x<span class="math">\(1\)</span> vector of the positions of the atoms. The solutions of the equation may be cast in the form of an eigenvalue decomposition of <span class="math">\(\mathbf{H}\)</span> where the eigenvectors are the mass weighted displacements of the normal coordinates; i.e. the independent vibrational motions of the collection of atoms. The corresponding eigenvalues are the negative of the squared normal mode frequencies of each mode. <span class="math">\(\mathbf{H}\)</span> has exactly six zero eigenvalues for the translations and rotations of the molecule in three-dimensional space.</p>
<p>In NMA of proteins, it is central to obtain a good representation of the protein for a proper analysis of the available modes of motion. One approach would be to obtain the Hessian matrix from the second derivatives of the energy for the conformation of interest following a very stringent minimization of the molecule. The latter is important as NMA is based on the harmonic assumption which is only a valid approximation at the bottom of the potential energy minima. For the complex potentials representing interactions in proteins in the water environment, these second derivatives may be obtained through numerical methods which are extremely costly.</p>
<p>Alternatively, <span class="math">\(\mathbf{H}\)</span> may be approximated by the variance-covariance matrix of the protein, obtained from a molecular dynamics (MD) simulation of suitable length. This is relevant as it may be shown through employing statistical mechanics that the average displacements of nodes from a mean structure for an atom <span class="math">\(i, \Delta \mathbf{R}_{i}\)</span> are related to those of all other atoms through the relationship,</p>
<div class="math">
\[&lt; \Delta \mathbf{R}_{i} \cdot \Delta \mathbf{R}_{j} &gt; = 3k_{B}T \mathbf{H}^{-1}\]</div>
<p>It is important to select the length of the MD simulation for this procedure such that the molecule samples only the state of interest, <a class="footnote-reference" href="#id4" id="id1">[1]</a> since when more than a single potential energy well along the conformational space of the molecule is sampled, the harmonic assumption would again fail.</p>
<p>As a third alternative for obtaining the Hessian, one may make use of the elastic network property of a folded protein. Here, the assumption is that, once a protein folds to a functionally relevant conformation, its total energy is represented by a simple harmonic potential such that residues are connected to their nearest neighbors via elastic springs. By further employing the assumption that the spring constants, <span class="math">\(\gamma\)</span>, are equivalent in all pairs of interactions, one arrives at the anisotropic network model (ANM). <a class="footnote-reference" href="#id5" id="id2">[2]</a></p>
<p><span class="math">\(\mathbf{H}\)</span> is thus composed of <span class="math">\(N\)</span>x<span class="math">\(N\)</span> super-elements, i.e.,</p>
<div class="math">
\[\begin{split}\mathbf{H} =
 \begin{bmatrix}
  \mathbf{H}_{1,1} &amp; \mathbf{H}_{1,2} &amp; \cdots &amp; \mathbf{H}_{1,\mathbf{N}} \\
  \mathbf{H}_{2,1} &amp;         &amp;        &amp; \mathbf{H}_{2,\mathbf{N}} \\
  \vdots  &amp;         &amp;        &amp; \vdots  \\
  \mathbf{H}_{\mathbf{N},1} &amp;         &amp;        &amp; \mathbf{H}_{\mathbf{N},\mathbf{N}}
 \end{bmatrix}\end{split}\]</div>
<p>where each super-element <span class="math">\(\mathbf{H_{ij}}\)</span>   is a 3x3 matrix that holds the anisotropic information regarding the orientation of nodes <span class="math">\(i,j\)</span>:</p>
<div class="math">
\[\begin{split}\mathbf{H_{ij}} =
    \begin{bmatrix}
 \partial ^2 V / \partial X_{i} \partial X_{j} &amp; \partial ^2 V / \partial X_{i} \partial Y_{j} &amp; \partial ^2 V / \partial X_{i} \partial Z_{j} \\
 \partial ^2 V / \partial Y_{i} \partial X_{j} &amp; \partial ^2 V / \partial Y_{i} \partial Y_{j} &amp; \partial ^2 V / \partial Y_{i} \partial Z_{j} \\
 \partial ^2 V / \partial Z_{i} \partial X_{j} &amp; \partial ^2 V / \partial Z_{i} \partial Y_{j} &amp; \partial ^2 V / \partial Z_{i} \partial Z_{j} \\
\end{bmatrix}\end{split}\]</div>
<p>Denoting the separation between nodes <span class="math">\(i\)</span> and <span class="math">\(j\)</span> by <span class="math">\(S_{ij}\)</span>, the elements of the off-diagonal super-elements <span class="math">\(\mathbf{H_{ij}}\)</span> are given by:</p>
<div class="math">
\[\partial ^2 V / \partial X_{i} \partial Y_{j} = -\gamma (X_{j}-X_{i})(Y_{j}-Y_{i})/S^2_{ij}\]</div>
<p>and those of the diagonal super-elements <span class="math">\(\mathbf{H_{ij}}\)</span> are obtained via,</p>
<div class="math">
\[\partial ^2 V / \partial X^2_{i} = \gamma \sum_{j}(X_{j}-X_{i})^2/S^2_{ij} \text{ } \text{ } \text{ for the diagonal terms}\]</div>
<div class="math">
\[\partial ^2 V / \partial X_{i} \partial Y_{j} = \gamma \sum_{j} (X_{j}-X_{i})(Y_{j}-Y_{i})/S^2_{ij} \text{ } \text{ } \text{ for the off-diagonal terms.}\]</div>
<p>In this representation of the protein, the structure is coarse-grained at the level of a residue, usually through the coordinates of <span class="math">\(\mathbf{C_\alpha}\)</span> or <span class="math">\(\mathbf{C_\beta}\)</span> atoms obtained from the protein data bank. Moreover, pairs of nodes are assumed to interact if they are within a pre-selected cut-off distance, <span class="math">\(r_{c}\)</span>. For large structures such as viruses, further coarse graining may be shown to well describe the most collective modes of motion.</p>
<p>The selection of <span class="math">\(r_{c}\)</span> has been the cause of much research. While it is clear that there is a lower bound where the condition of six zero eigenvalues of <span class="math">\(\mathbf{H}\)</span> should be satisfied, distances in the range 10-25 Å have been employed in the literature. It has been shown by a systematic study of increasing <span class="math">\(r_{c}\)</span> that the collective modes of motion do not change beyond a certain value for proteins; i.e. selection of too large <span class="math">\(r_{c}\)</span> is safer than a too small value. <a class="footnote-reference" href="#id6" id="id3">[3]</a> The reason for this has been explained by expressing <span class="math">\(\mathbf{H}\)</span> as the sum of an essential and a trivial part. The essential part of <span class="math">\(\mathbf{H}\)</span> includes all the local information necessary for the correct representation of the modes. On the other hand, due to the symmetries in a protein originating from the orientational order of closely packed spheres, the effects from the long range neighbors cancel out.</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>C Atilgan, OB Okan, AR Atilgan, “Network-based Models as Tools Hinting at Non-evident Protein Functionality,” Annual Review of Biophysics,&nbsp;41, 205-225 (2012).</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>AR Atilgan, SR Durell, RL Jernigan, MC Demirel, O Keskin, I Bahar, “Anisotropy of Fluctuation Dynamics of Proteins with an Elastic Network Model,” Biophysical Journal,&nbsp;80, 505-515.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td>C Atilgan, OB Okan, AR Atilgan, “Orientational Order Governs Collectivity of Folded Proteins,”&nbsp;Proteins: Structure, Function, Bioinformatics, 78, 3363-3375 (2010).</td></tr>
</tbody>
</table>
</div>
<div class="section" id="principle-component-analysis-pca">
<h1>Principle Component Analysis (PCA)<a class="headerlink" href="#principle-component-analysis-pca" title="Permalink to this headline">¶</a></h1>
<p>A molecular dynamics (MD) simulation of a protein provides the positional movements of each atom with
respect to a fixed reference frame at a given time. The mean squared positional fluctuations (variances) of
each atom are readily calculated once the total simulation and sampling times are set. Sufficiency of both
total observation period and the sampling rate are crucial in collecting the data so as to identify biologically
relevant motions.
Let us monitor the variance of each residue’s <span class="math">\(\mathbf{C_\alpha}\)</span> or <span class="math">\(\mathbf{C_\beta}\)</span> atom during a MD simulation of a protein. Suppose
that these variances do not change significantly in time, like a stationary process. This suggests that within
the period of observation we have recorded the motion about one (native) conformation. Though constant in
time for a given residue, the variances do change from one residue to another. It is important to distinguish
the differences between the variances of different parts of the protein and to explain the root cause of these
differences; e.g. while loop or disordered regions exhibit high values, relatively rigid parts, such as helices
or sheets display lower variances.</p>
<p>PCA <a class="footnote-reference" href="#id9" id="id7">[4]</a> operates on the variance-covariance matrix, <span class="math">\(\mathbf{C}\)</span>, of the protein, obtained from a MD simulation of any
length; thus, the observed process need not be stationary. It is useful in distinguishing the different parts of
the energy landscape sampled during the MD simulation. To obtain <span class="math">\(\mathbf{C}\)</span>, first the protein coordinates are
superimposed on a reference structure, usually the initial coordinates, or the average coordinates. The
displacement vector for each residue (described by the <span class="math">\(\mathbf{C_\alpha}\)</span> or <span class="math">\(\mathbf{C_\beta}\)</span> coordinates of the residue <span class="math">\(i\)</span>) at a time point
<span class="math">\(t, \Delta \mathbf{R}_{i}(t)\)</span> is obtained. For a set of <span class="math">\(M\)</span> recorded coordinates, these are organized in the trajectory fluctuation
matrix of order <span class="math">\(3N\)</span>x<span class="math">\(M\)</span>:</p>
<div class="math">
\[\begin{split}\Delta \mathbf{R} =
    \begin{bmatrix}
  \Delta \mathbf{R}_{1}(t_{1}) &amp; \Delta \mathbf{R}_{1}(t_{2}) &amp; \cdot &amp; \Delta \mathbf{R}_{1}(t_{M}) \\
  \Delta \mathbf{R}_{2}(t_{1}) &amp; \Delta \mathbf{R}_{2}(t_{2}) &amp; \cdot &amp; \Delta \mathbf{R}_{2}(t_{M}) \\
  \Delta \mathbf{R}_{3}(t_{1}) &amp; \Delta \mathbf{R}_{3}(t_{2}) &amp; \cdot &amp; \Delta \mathbf{R}_{3}(t_{M}) \\
  \cdot &amp; \cdot &amp; \cdot &amp; \cdot \\
  \cdot &amp; \cdot &amp; \cdot &amp; \cdot \\
  \Delta \mathbf{R}_{n}(t_{1}) &amp; \Delta \mathbf{R}_{n}(t_{2}) &amp;  &amp; \Delta \mathbf{R}_{n}(t_{M}) \\
\end{bmatrix}\end{split}\]</div>
<p>The <span class="math">\(3N\)</span>x<span class="math">\(3N\)</span> <span class="math">\(\mathbf{C}\)</span> matrix is then obtained via the operation,</p>
<div class="math">
\[\mathbf{C} = \Delta \mathbf{R} \Delta \mathbf{R}^{\mathbf{T}}\]</div>
<p>If a single energy well along the potential energy surface of a protein is sampled, then <span class="math">\(\mathbf{C}\)</span> approximates the
inverse Hessian, <span class="math">\(\mathbf{H}^{-1}\)</span> , as the harmonic approximation applies in this case (see NMA for details). However, if
different parts of the landscape are sampled, the decomposition of <span class="math">\(\mathbf{C}\)</span> will carry information on all the
regions entered during the simulation. Thus, the diagonalization,</p>
<div class="math">
\[\mathbf{C = U \Lambda U ^T}\]</div>
<p>yields the eigenvectors and the corresponding eigenvalues of the <span class="math">\(\mathbf{C}\)</span> matrix. <span class="math">\(\mathbf{\Lambda}\)</span> is the <span class="math">\(3N\)</span>x<span class="math">\(3N\)</span> diagonal
matrix holding the eigenvalues <span class="math">\(\lambda_i\)</span> with six zero values corresponding to the translations and rotations of the
molecule. The <span class="math">\(i\mathrm{^{th}}\)</span>  row of the <span class="math">\(\mathbf{U}\)</span> matrix holding the eigenvector corresponding to the <span class="math">\(i\mathrm{^{th}}\)</span> eigenvalue. The
trajectory <span class="math">\(\Delta \mathbf{R}\)</span>  may be projected onto the eigenvectors to obtain the principal components, <span class="math">\(q_i\)</span>, which are the rows
of the <span class="math">\(3N\)</span>x<span class="math">\(M\)</span> <span class="math">\(\mathbf{Q}\)</span> matrix.</p>
<div class="math">
\[\mathbf{Q = U} \Delta \mathbf{R}\]</div>
<p>Since a few principal components usually carry the largest amount of information of the trajectory, the
different regions of the conformational space will manifest as more than one blob in a plot of <span class="math">\(q_i\)</span> versus <span class="math">\(q_j\)</span>
where <span class="math">\(i\)</span> and <span class="math">\(j\)</span> are small. Furthermore, the size of the blobs in the plots will provide information on the width
of the potential wells sampled. Finally, the time points when passage between different wells occur may be
pinpointed by this method.
The different implementations of the construction of the <span class="math">\(\mathbf{C}\)</span> matrix and the various ways of decomposing it
have been discussed in detail in the literature, <a class="footnote-reference" href="#id10" id="id8">[5]</a> and implemented in MODE-TASK.</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[4]</a></td><td>A Amadei, ABM Linssen, HJC Berendsen, “Essential Dynamics of Proteins,” Proteins: Structure, Function and Genetics, 17, 412-425 (1993).</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[5]</a></td><td>CC David, DJ Jacobs, “Principal component analysis: a method for determining the essential dynamics of proteins,” Methods in Molecular Biology, 1084, 193-226 (2014).</td></tr>
</tbody>
</table>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="nma_use.html" class="btn btn-neutral float-right" title="NMA Scripts" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral" title="Installation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, CJ Ross, B Nizami, M Glenister, OS Amamuddy, AR Atilgan, C Atilgan and Ö Tastan Bishop.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>