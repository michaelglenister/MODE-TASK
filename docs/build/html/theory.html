

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Theory &mdash; NMA-Task  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="NMA-Task  documentation" href="index.html"/>
        <link rel="next" title="NMA Scripts" href="nma.html"/>
        <link rel="prev" title="Installation" href="installation.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> NMA-Task
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#normal-mode-analysis-nma">Normal Mode Analysis (NMA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#principle-component-analysis-pca">Principle Component Analysis (PCA)</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nma.html">NMA Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="pca.html">PCA Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo.html">Tool Demonstration</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">NMA-Task</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Theory</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/theory.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="theory">
<h1>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h1>
<div class="section" id="normal-mode-analysis-nma">
<h2>Normal Mode Analysis (NMA)<a class="headerlink" href="#normal-mode-analysis-nma" title="Permalink to this headline">¶</a></h2>
<p>NMA analyses the oscillations of a structure. For proteins, it is useful for studying the large amplitude motions for a selected conformation. The main assumption is that the motions are harmonic. Thus, each normal mode, which is a concerted motion of many atoms, acts as a simple harmonic oscillator and it is independent of all the other normal modes.</p>
<p>For a harmonic oscillator with a mass m supported on a spring with force constant <em>k</em>, the potential energy of the system, <em>V</em> = <em>kx</em><sup>2</sup>, for an extension <em>x</em> leads to the restoring force,</p>
<img alt="_images/nma1.png" src="_images/nma1.png" />
<p>By substituting this Hooke’s Law force into Newton’s Law, <strong>F</strong> = <em>m</em><strong>a</strong> leads to the differential equation,</p>
<img alt="_images/nma2.png" src="_images/nma2.png" />
<p>The solution is, <img alt="nma3" src="_images/nma3.png" /> with <img alt="nma4" src="_images/nma4.png" /> being the frequency of the vibration.</p>
<p>In three dimensions and for a set of <em>N</em> atoms, one has the corresponding generalized equation,</p>
<p><strong>-HX</strong> = <strong>-</strong> <img alt="nma5" src="_images/nma5.png" /> <strong>X</strong></p>
<p>where <strong>H</strong> is the 3<em>N</em> x 3<em>N</em> Hessian symmetric matrix of force constants and <strong>X</strong> is the 3<em>N</em> x 1 vector of the positions of the atoms. The solutions of the equation may be cast in the form of an eigenvalue decomposition of <strong>H</strong> where the eigenvectors are the mass weighted displacements of the normal coordinates; i.e. the independent vibrational motions of the collection of atoms. The corresponding eigenvalues are the negative of the squared normal mode frequencies of each mode. <strong>H</strong> has exactly six zero eigenvalues for the translations and rotations of the molecule in three-dimensional space.</p>
<p>In NMA of proteins, it is central to obtain a good representation of the protein for a proper analysis of the available modes of motion. One approach would be to obtain the Hessian matrix from the second derivatives of the energy for the conformation of interest following a very stringent minimization of the molecule. The latter is important as NMA is based on the harmonic assumption which is only a valid approximation at the bottom of the potential energy minima. For the complex potentials representing interactions in proteins in the water environment, these second derivatives may be obtained through numerical methods which are extremely costly.</p>
<p>Alternatively, <strong>H</strong> may be approximated by the variance-covariance matrix of the protein, obtained from a molecular dynamics (MD) simulation of suitable length. This is relevant as it may be shown through employing statistical mechanics that the average displacements of nodes from a mean structure for an atom i, 🜂<strong>R</strong><sub>i</sub> are related to those of all other atoms through the relationship,</p>
<p>&lt; 🜂<strong>R</strong><sub>i</sub> ∙ 🜂<strong>R</strong><sub>j</sub> &gt; =3<em>k</em><sub>B</sub><em>T</em>  <strong>H</strong><sup>-1</sup></p>
<p>It is important to select the length of the MD simulation for this procedure such that the molecule samples only the state of interest,<sup>1</sup> since when more than a single potential energy well along the conformational space of the molecule is sampled, the harmonic assumption would again fail.</p>
<p>As a third alternative for obtaining the Hessian, one may make use of the elastic network property of a folded protein. Here, the assumption is that, once a protein folds to a functionally relevant conformation, its total energy is represented by a simple harmonic potential such that residues are connected to their nearest neighbors via elastic springs. By further employing the assumption that the spring constants, ϒ, are equivalent in all pairs of interactions, one arrives at the anisotropic network model (ANM).<sup>2</sup></p>
<p><strong>H</strong> is thus composed of <em>N</em> x <em>N</em> super-elements, i.e.,</p>
<img alt="_images/nma7.png" src="_images/nma7.png" />
<p>where each super-element <strong>H</strong><sub>ij</sub>   is a 3 x 3 matrix that holds the anisotropic information regarding the orientation of nodes <em>i</em>,*j*:</p>
<img alt="_images/nma8.png" src="_images/nma8.png" />
<p>Denoting the separation between nodes <em>i</em> and <em>j</em> by <img alt="nma9" src="_images/nma9.png" /> , the elements of the off-diagonal super-elements <strong>H</strong><sub>ij</sub> are given by:</p>
<img alt="_images/nma10.png" src="_images/nma10.png" />
<p>and those of the diagonal super-elements <strong>H</strong><sub>ii</sub> are obtained via,</p>
<p><img alt="nma11" src="_images/nma11.png" /> for the diagonal terms</p>
<p><img alt="nma12" src="_images/nma12.png" /> for the off-diagonal terms.</p>
<p>In this representation of the protein, the structure is coarse-grained at the level of a residue, usually through the coordinates of Cα or Cβ atoms obtained from the protein data bank. Moreover, pairs of nodes are assumed to interact if they are within a pre-selected cut-off distance, <em>r</em><sub>c</sub>. For large structures such as viruses, further coarse graining may be shown to well describe the most collective modes of motion.</p>
<p>The selection of <em>r</em><sub>c</sub> has been the cause of much research. While it is clear that there is a lower bound where the condition of six zero eigenvalues of <strong>H</strong> should be satisfied, distances in the range 10-25 Å have been employed in the literature. It has been shown by a systematic study of increasing <em>r</em><sub>c</sub> that the collective modes of motion do not change beyond a certain value for proteins; i.e. selection of too large <em>r</em><sub>c</sub> is safer than a too small value.<sup>3</sup> The reason for this has been explained by expressing <strong>H</strong> as the sum of an essential and a trivial part. The essential part of <strong>H</strong> includes all the local information necessary for the correct representation of the modes. On the other hand, due to the symmetries in a protein originating from the orientational order of closely packed spheres, the effects from the long range neighbors cancel out.</p>
<ol class="arabic simple">
<li><ol class="first upperalpha" start="3">
<li>Atilgan, O.B. Okan, A.R. Atilgan, “Network-based Models as Tools Hinting at Non-evident Protein Functionality,” Annual Review of Biophysics,&nbsp;41, 205-225 (2012).</li>
</ol>
</li>
<li>A.R. Atilgan, S.R., Durell, R.L. Jernigan, M.C. Demirel, O. Keskin, I. Bahar, “Anisotropy of Fluctuation Dynamics of Proteins with an Elastic Network Model,” Biophysical Journal,&nbsp;80, 505-515.</li>
<li><ol class="first upperalpha" start="3">
<li>Atilgan, O.B. Okan, A.R. Atilgan, “Orientational Order Governs Collectivity of Folded Proteins,”&nbsp;Proteins: Structure, Function, Bioinformatics, 78, 3363-3375 (2010).</li>
</ol>
</li>
</ol>
</div>
<div class="section" id="principle-component-analysis-pca">
<h2>Principle Component Analysis (PCA)<a class="headerlink" href="#principle-component-analysis-pca" title="Permalink to this headline">¶</a></h2>
<p>A molecular dynamics (MD) simulation of a protein provides the positional movements of each atom with
respect to a fixed reference frame at a given time. The mean squared positional fluctuations (variances) of
each atom are readily calculated once the total simulation and sampling times are set. Sufficiency of both
total observation period and the sampling rate are crucial in collecting the data so as to identify biologically
relevant motions.
Let us monitor the variance of each residue’s Cα (or Cβ) atom during a MD simulation of a protein. Suppose
that these variances do not change significantly in time, like a stationary process. This suggests that within
the period of observation we have recorded the motion about one (native) conformation. Though constant in
time for a given residue, the variances do change from one residue to another. It is important to distinguish
the differences between the variances of different parts of the protein and to explain the root cause of these
differences; e.g. while loop or disordered regions exhibit high values, relatively rigid parts, such as helices
or sheets display lower variances.</p>
<p>PCA<sup>1</sup> operates on the variance-covariance matrix, <strong>C</strong>, of the protein, obtained from a MD simulation of any
length; thus, the observed process need not be stationary. It is useful in distinguishing the different parts of
the energy landscape sampled during the MD simulation. To obtain <strong>C</strong>, first the protein coordinates are
superimposed on a reference structure, usually the initial coordinates, or the average coordinates. The
displacement vector for each residue (described by the Cα or Cβ coordinates of the residue <em>i</em> ) at a time point
<em>t</em>,🜂<strong>R</strong><sub>i</sub>(t) is obtained. For a set of <em>M</em> recorded coordinates, these are organized in the trajectory fluctuation
matrix of order 3<em>N</em> x <em>M</em>:</p>
<img alt="_images/pca1.png" src="_images/pca1.png" />
<p>The 3<em>N</em> x 3<em>N</em> <strong>C</strong> matrix is then obtained via the operation,</p>
<img alt="_images/pca2.png" src="_images/pca2.png" />
<p>If a single energy well along the potential energy surface of a protein is sampled, then <strong>C</strong> approximates the
inverse Hessian, <strong>H</strong><sup>-1</sup> , as the harmonic approximation applies in this case (see NMA for details). However, if
different parts of the landscape are sampled, the decomposition of <strong>C</strong> will carry information on all the
regions entered during the simulation. Thus, the diagonalization,</p>
<img alt="_images/pca3.png" src="_images/pca3.png" />
<p>yields the eigenvectors and the corresponding eigenvalues of the <strong>C</strong> matrix. <strong>Ʌ</strong> is the 3<em>N</em> x 3<em>N</em> diagonal
matrix holding the eigenvalues <em>λ</em><sub>i</sub> with six zero values corresponding to the translations and rotations of the
molecule. The <em>i</em> <sup>th</sup>  row of the <strong>U</strong> matrix holding the eigenvector corresponding to the <em>i</em> <sup>th</sup> eigenvalue. The
trajectory <img alt="pca4" src="_images/pca4.png" /> may be projected onto the eigenvectors to obtain the principal components, <em>q</em><sub>i</sub>, which are the rows
of the 3<em>N</em> x <em>M</em> <strong>Q</strong> matrix.</p>
<img alt="_images/pca5.png" src="_images/pca5.png" />
<p>Since a few principal components usually carry the largest amount of information of the trajectory, the
different regions of the conformational space will manifest as more than one blob in a plot of <em>q</em><sub>i</sub> versus <em>q</em><sub>j</sub>
where <em>i</em> and <em>j</em> are small. Furthermore, the size of the blobs in the plots will provide information on the width
of the potential wells sampled. Finally, the time points when passage between different wells occur may be
pinpointed by this method.
The different implementations of the construction of the <strong>C</strong> matrix and the various ways of decomposing it
have been discussed in detail in the literature,<sup>2</sup> and implemented in MODE-TASK.</p>
<ol class="arabic simple">
<li><ol class="first upperalpha">
<li>Amadei, A.B.M. Linssen, H.J.C. Berendsen, “Essential Dynamics of Proteins,” Proteins: Structure, Function and Genetics, 17, 412-425 (1993).</li>
</ol>
</li>
<li>C.C. David, D.J. Jacobs, “Principal component analysis: a method for determining the essential dynamics of proteins,” Methods in Molecular Biology, 1084, 193-226 (2014).</li>
</ol>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="nma.html" class="btn btn-neutral float-right" title="NMA Scripts" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral" title="Installation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Michael Glenister.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>